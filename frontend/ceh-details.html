<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEH v13 Details - Architect Johan</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', Courier, monospace;
            background: #02040A;
            color: #00FFB3;
            overflow-x: hidden;
            min-height: 100vh;
            animation: fadeIn 1s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Matrix background */
        #matrix-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            opacity: 0.3;
        }

        /* Navbar */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(2, 4, 10, 0.9);
            backdrop-filter: blur(15px);
            border-bottom: 2px solid #00FFB3;
            padding: 20px 40px;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 0 30px rgba(0, 255, 179, 0.3);
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 3px;
            text-shadow: 0 0 15px rgba(0, 255, 179, 0.8);
            background: linear-gradient(135deg, #00FFB3 0%, #2EC6FF 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-links {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .nav-links a {
            color: #00FFB3;
            text-decoration: none;
            text-transform: uppercase;
            font-size: 14px;
            letter-spacing: 2px;
            padding: 8px 16px;
            border-radius: 5px;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-links a:hover {
            color: #2EC6FF;
            text-shadow: 0 0 10px rgba(46, 198, 255, 0.8);
        }

        .nav-links a.active {
            color: #2EC6FF;
            background: rgba(46, 198, 255, 0.1);
            box-shadow: 0 0 15px rgba(46, 198, 255, 0.5);
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #00FFB3, #2EC6FF);
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }

        .nav-links a:hover::after {
            width: 80%;
        }

        /* Profile section in navbar */
        .profile-section {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-left: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .profile-section:hover {
            transform: translateY(-2px);
        }

        .profile-image {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #00FFB3;
            object-fit: cover;
            background: linear-gradient(135deg, #00FFB3, #2EC6FF);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #02040A;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .profile-section:hover .profile-image {
            border-color: #2EC6FF;
            box-shadow: 0 0 20px rgba(46, 198, 255, 0.6);
            transform: scale(1.1);
        }

        /* Logout button specific styles */
        .logout-btn {
            color: #FF6B6B !important;
            background: rgba(255, 107, 107, 0.1) !important;
            border: 1px solid rgba(255, 107, 107, 0.3) !important;
        }

        .logout-btn:hover {
            color: #FF5252 !important;
            background: rgba(255, 107, 107, 0.2) !important;
            text-shadow: 0 0 10px rgba(255, 107, 107, 0.8) !important;
            border-color: #FF6B6B !important;
        }

        /* Main content */
        .main-content {
            position: relative;
            z-index: 10;
            padding: 150px 40px 100px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .page-header {
            text-align: center;
            margin-bottom: 60px;
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        .page-header h1 {
            font-size: 48px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 4px;
            margin-bottom: 20px;
            text-shadow: 0 0 25px rgba(0, 255, 179, 0.8),
                         0 0 50px rgba(0, 255, 179, 0.5);
            background: linear-gradient(135deg, #00FFB3 0%, #2EC6FF 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .page-header p {
            font-size: 18px;
            color: #2EC6FF;
            text-transform: uppercase;
            letter-spacing: 3px;
            opacity: 0.9;
        }

        /* Course overview */
        .course-overview {
            background: rgba(2, 4, 10, 0.9);
            backdrop-filter: blur(15px);
            border: 2px solid #00FFB3;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 0 40px rgba(0, 255, 179, 0.3),
                        inset 0 0 40px rgba(0, 255, 179, 0.05);
        }

        .course-overview h2 {
            font-size: 32px;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #00FFB3 0%, #2EC6FF 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-align: center;
        }

        .course-overview p {
            color: #2EC6FF;
            line-height: 1.7;
            margin-bottom: 20px;
            font-size: 16px;
            text-align: center;
        }

        /* Download sections */
        .download-sections {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .download-section {
            background: rgba(2, 4, 10, 0.9);
            backdrop-filter: blur(15px);
            border: 2px solid #00FFB3;
            border-radius: 20px;
            padding: 30px;
            transition: all 0.4s ease;
            box-shadow: 0 0 40px rgba(0, 255, 179, 0.3),
                        inset 0 0 40px rgba(0, 255, 179, 0.05);
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .download-section:hover {
            transform: translateY(-5px);
            border-color: #2EC6FF;
            box-shadow: 0 0 60px rgba(46, 198, 255, 0.5),
                        inset 0 0 50px rgba(46, 198, 255, 0.1);
        }

        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            justify-content: center;
        }

        .section-icon {
            width: 70px;
            height: 70px;
            border: 3px solid #00FFB3;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 20px;
            background: rgba(0, 255, 179, 0.1);
            box-shadow: 0 0 20px rgba(0, 255, 179, 0.4);
            transition: all 0.4s ease;
            font-size: 24px;
            font-weight: bold;
        }

        .download-section:hover .section-icon {
            border-color: #2EC6FF;
            box-shadow: 0 0 30px rgba(46, 198, 255, 0.8);
        }

        .section-title {
            font-size: 28px;
            text-transform: uppercase;
            letter-spacing: 2px;
            background: linear-gradient(135deg, #00FFB3 0%, #2EC6FF 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-align: center;
        }

        .section-description {
            color: #2EC6FF;
            text-align: center;
            margin-top: 15px;
            font-size: 16px;
        }

        /* Password Modal */
        .password-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(2, 4, 10, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .password-modal-content {
            background: rgba(2, 4, 10, 0.95);
            border: 2px solid #00FFB3;
            border-radius: 20px;
            padding: 40px;
            width: 90%;
            max-width: 500px;
            text-align: center;
            box-shadow: 0 0 50px rgba(0, 255, 179, 0.5);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .password-modal h2 {
            font-size: 28px;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #00FFB3 0%, #2EC6FF 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .password-input {
            width: 100%;
            padding: 15px 20px;
            background: rgba(0, 255, 179, 0.1);
            border: 2px solid #00FFB3;
            border-radius: 10px;
            color: #00FFB3;
            font-size: 16px;
            margin-bottom: 20px;
            text-align: center;
            font-family: 'Courier New', monospace;
            transition: all 0.3s ease;
        }

        .password-input:focus {
            outline: none;
            border-color: #2EC6FF;
            box-shadow: 0 0 20px rgba(46, 198, 255, 0.5);
        }

        .password-input::placeholder {
            color: #2EC6FF;
            opacity: 0.7;
        }

        .password-btn {
            padding: 15px 40px;
            background: linear-gradient(135deg, #00FFB3 0%, #2EC6FF 100%);
            color: #02040A;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .password-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 255, 179, 0.5);
        }

        .password-btn.cancel {
            background: linear-gradient(135deg, #FF6B6B 0%, #FF5252 100%);
        }

        .error-message {
            color: #FF6B6B;
            margin-top: 10px;
            font-size: 14px;
            display: none;
        }

        /* Back buttons */
        .back-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 50px;
        }

        .back-btn {
            display: inline-block;
            padding: 15px 40px;
            background: linear-gradient(135deg, #00FFB3 0%, #2EC6FF 100%);
            color: #02040A;
            text-decoration: none;
            text-transform: uppercase;
            font-weight: bold;
            letter-spacing: 3px;
            border-radius: 12px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            font-size: 16px;
            border: none;
            cursor: pointer;
        }

        .back-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .back-btn:hover::before {
            width: 400px;
            height: 400px;
        }

        .back-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 255, 179, 0.8);
        }

        /* Footer */
        .footer {
            position: relative;
            z-index: 10;
            text-align: center;
            padding: 40px;
            margin-top: 80px;
            border-top: 1px solid rgba(0, 255, 179, 0.2);
            color: #2EC6FF;
            font-size: 14px;
            letter-spacing: 2px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .navbar {
                padding: 15px 20px;
                flex-direction: column;
                gap: 15px;
            }

            .nav-links {
                gap: 15px;
                flex-wrap: wrap;
                justify-content: center;
            }

            .profile-section {
                margin-left: 0;
                gap: 10px;
            }

            .main-content {
                padding: 180px 20px 80px;
            }

            .page-header h1 {
                font-size: 36px;
            }

            .download-sections {
                grid-template-columns: 1fr;
            }

            .section-header {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }

            .section-icon {
                margin-right: 0;
            }

            .back-buttons {
                flex-direction: column;
                gap: 20px;
            }

            .back-btn {
                text-align: center;
            }

            .password-modal-content {
                padding: 30px 20px;
                margin: 20px;
            }
        }

        @media (max-width: 480px) {
            .nav-links {
                flex-wrap: wrap;
                justify-content: center;
            }

            .page-header h1 {
                font-size: 28px;
            }

            .page-header p {
                font-size: 14px;
            }

            .section-title {
                font-size: 22px;
            }

            .course-overview {
                padding: 25px;
            }
        }
    </style>
</head>
<body>
    <!-- Matrix background -->
    <canvas id="matrix-canvas"></canvas>

    <!-- Password Modal -->
    <div class="password-modal" id="passwordModal">
        <div class="password-modal-content">
            <h2>Enter Password</h2>
            <p style="color: #2EC6FF; margin-bottom: 20px;">Please enter the password to access CEH v13 Study Notes</p>
            <input type="password" class="password-input" id="passwordInput" placeholder="Enter password..." autocomplete="off">
            <div class="error-message" id="passwordError">Incorrect password. Please try again.</div>
            <div style="margin-top: 25px;">
                <button class="password-btn" onclick="verifyPassword()">Verify Password</button>
                <button class="password-btn cancel" onclick="closePasswordModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Navbar -->
    <nav class="navbar">
        <div class="logo">Architect Johan</div>
        <div class="nav-links">
            <a href="home.html">Home</a>
            <a href="videos.html">Videos</a>
            <a href="notes.html" class="active">Notes</a>
            <a href="trending.html">Trending Videos</a>
            <a href="announcements.html">Announcements</a>
            <a href="support.html">Support</a>
            <a href="about.html">About</a>
            
            <!-- Profile Section -->
            <div class="profile-section" id="profile-section">
                <div class="profile-image" id="nav-profile-image">AJ</div>
            </div>
            
            <a href="#" id="logout-btn" class="logout-btn">Logout</a>
        </div>
    </nav>

    <!-- Main content -->
    <div class="main-content">
        <div class="page-header">
            <h1>CEH v13</h1>
            <p>Certified Ethical Hacker - Complete Package</p>
        </div>

        <div class="course-overview">
            <h2>Course Overview</h2>
            <p>The Certified Ethical Hacker (CEH v13) program provides comprehensive training in ethical hacking and network security. This complete package includes everything you need to master ethical hacking techniques and pass the CEH certification exam.</p>
            <p>Our materials cover all 20 modules of the official CEH curriculum, including hands-on labs, practice exams, and real-world scenarios to prepare you for a career in cybersecurity.</p>
        </div>

        <div class="download-sections">
            <!-- Software Downloads -->
            <div class="download-section" onclick="handleDownloadClick('software_downloads.html', 'CEH Software Downloads')">
                <div class="section-header">
                    <div class="section-icon">üíª</div>
                    <h2 class="section-title">Software Downloads</h2>
                </div>
                <p class="section-description">Essential hacking tools and platforms</p>
            </div>

            <!-- Notes -->
            <div class="download-section" onclick="openPasswordModal()">
                <div class="section-header">
                    <div class="section-icon">üìù</div>
                    <h2 class="section-title">Study Notes</h2>
                </div>
                <p class="section-description">Comprehensive study materials and guides</p>
            </div>

            <!-- Practice Sets -->
            <div class="download-section" onclick="handleDownloadClick('cehv13.html', 'CEH Theory Exam')">
                <div class="section-header">
                    <div class="section-icon">üîç</div>
                    <h2 class="section-title">Cehv13 Theory Exam</h2>
                </div>
                <p class="section-description">Exams, labs, and real-world scenarios</p>
            </div>
        </div>

        <div class="back-buttons">
            <a href="notes.html" class="back-btn">Back to Notes</a>
            <a href="home.html" class="back-btn">Back to Home</a>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        ¬© 2025 Architect Johan | All Rights Reserved.
    </footer>

    <script>
        // API Base URL
        const API_BASE_URL = 'https://architect-johan-secure.onrender.com';

        // Global variables
        let currentTargetUrl = '';

        // Authentication check
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthentication();
            loadUserProfileForNavbar();
        });

        // Check if user is authenticated
        async function checkAuthentication() {
            const token = localStorage.getItem('auth_token');
            
            if (!token) {
                console.log('‚ùå No authentication token found');
                window.location.href = 'index.html';
                return;
            }

            try {
                // Validate token with backend
                const response = await fetch(`${API_BASE_URL}/api/validate-token`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    console.log('‚ùå Token validation failed:', response.status);
                    // Clear invalid token and redirect
                    localStorage.removeItem('auth_token');
                    localStorage.removeItem('username');
                    localStorage.removeItem('user_role');
                    window.location.href = 'index.html';
                    return;
                }

                const data = await response.json();
                console.log('‚úÖ User authenticated successfully:', data.username);
                
                // Update UI to show logged in user
                const username = localStorage.getItem('username');
                if (username) {
                    console.log('‚úÖ Welcome back, ' + username);
                }

            } catch (error) {
                console.error('‚ùå Authentication check failed:', error);
                // Clear tokens and redirect to login
                localStorage.removeItem('auth_token');
                localStorage.removeItem('username');
                localStorage.removeItem('user_role');
                window.location.href = 'index.html';
            }
        }

        // Load user profile data for navbar
        async function loadUserProfileForNavbar() {
            try {
                const token = localStorage.getItem('auth_token');
                if (!token) {
                    console.log('No authentication token found');
                    return;
                }

                const response = await fetch(`${API_BASE_URL}/api/user-profile`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });

                if (response.ok) {
                    const userData = await response.json();
                    updateNavbarProfile(userData);
                    
                    // Save user data to localStorage for fallback
                    saveUserDataToLocalStorage(userData);
                } else {
                    console.error('Failed to fetch user profile:', response.status);
                    // Fallback to localStorage data
                    loadUserDataFromLocalStorage();
                }
            } catch (error) {
                console.error('Error loading profile for navbar:', error);
                // Fallback to localStorage data
                loadUserDataFromLocalStorage();
            }
        }

        function updateNavbarProfile(userData) {
            const navProfileImage = document.getElementById('nav-profile-image');
            if (!navProfileImage) return;

            // Update profile image or initials
            if (userData.profile_image) {
                navProfileImage.innerHTML = '';
                navProfileImage.style.backgroundImage = `url(${userData.profile_image})`;
                navProfileImage.style.backgroundSize = 'cover';
                navProfileImage.style.backgroundPosition = 'center';
            } else {
                const initials = userData.full_name.split(' ').map(name => name[0]).join('').toUpperCase();
                navProfileImage.innerHTML = initials || 'AJ';
                navProfileImage.style.backgroundImage = 'none';
                navProfileImage.style.background = 'linear-gradient(135deg, #00FFB3, #2EC6FF)';
            }
        }

        function saveUserDataToLocalStorage(userData) {
            localStorage.setItem('full_name', userData.full_name);
            localStorage.setItem('email', userData.email);
            localStorage.setItem('username', userData.username);
            if (userData.join_date) {
                localStorage.setItem('join_date', new Date(userData.join_date).toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long'
                }));
            }
            if (userData.profile_image) {
                localStorage.setItem('profileImage', userData.profile_image);
            }
        }

        function loadUserDataFromLocalStorage() {
            const username = localStorage.getItem('username') || 'ArchitectJohan';
            const fullName = localStorage.getItem('full_name') || 'Architect Johan';
            const email = localStorage.getItem('email') || 'admin@architectjohan.com';

            // Update profile image from localStorage
            const navProfileImage = document.getElementById('nav-profile-image');
            const savedImage = localStorage.getItem('profileImage');
            
            if (navProfileImage) {
                if (savedImage) {
                    navProfileImage.innerHTML = '';
                    navProfileImage.style.backgroundImage = `url(${savedImage})`;
                    navProfileImage.style.backgroundSize = 'cover';
                    navProfileImage.style.backgroundPosition = 'center';
                } else {
                    // Use initials if no image
                    const initials = fullName.split(' ').map(name => name[0]).join('').toUpperCase();
                    navProfileImage.innerHTML = initials || 'AJ';
                    navProfileImage.style.backgroundImage = 'none';
                    navProfileImage.style.background = 'linear-gradient(135deg, #00FFB3, #2EC6FF)';
                }
            }
        }

        // Password Modal Functions
       function openPasswordModal() {
    currentTargetUrl = 'cehv13_notes.html'; // Make sure this file exists!
    const modal = document.getElementById('passwordModal');
    const passwordInput = document.getElementById('passwordInput');
    const errorMessage = document.getElementById('passwordError');
    
    console.log('Opening password modal for:', currentTargetUrl);
    
    modal.style.display = 'flex';
    passwordInput.value = '';
    errorMessage.style.display = 'none';
    passwordInput.focus();
}

        function closePasswordModal() {
            const modal = document.getElementById('passwordModal');
            modal.style.display = 'none';
            currentTargetUrl = '';
        }

  async function verifyPassword() {
    const password = document.getElementById('passwordInput').value;
    const errorMessage = document.getElementById('passwordError');
    const token = localStorage.getItem('auth_token');

    if (!password) {
        errorMessage.textContent = 'Please enter a password';
        errorMessage.style.display = 'block';
        return;
    }

    if (!token) {
        alert('Please log in to access this content.');
        window.location.href = 'index.html';
        return;
    }

    try {
        console.log('Verifying password for CEH Study Notes...');
        
        // Verify password with backend - using ceh_study_notes
        const response = await fetch(`${API_BASE_URL}/api/verify-practice-password`, {
            method: 'POST',
            headers: {
                'Authorization': `Bearer ${token}`,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                password: password,
                practice_set: 'ceh_study_notes'
            })
        });

        console.log('Response status:', response.status);

        if (response.ok) {
            const result = await response.json();
            console.log('Response data:', result);
            
            if (result.success) {
                // Password verified successfully
                console.log('Password verified!');
                closePasswordModal();
                
                // Track access and navigate
                await trackAccess('CEH Study Notes', 'CEH v13');
                
                // Force redirect to cehv13_notes.html
                setTimeout(() => {
                    window.location.href = 'cehv13_notes.html';
                }, 100);
                
            } else {
                errorMessage.textContent = result.error || 'Incorrect password. Please try again.';
                errorMessage.style.display = 'block';
                console.log('Password incorrect');
            }
        } else {
            const errorText = await response.text();
            console.error('Server error:', errorText);
            errorMessage.textContent = 'Server error. Please try again.';
            errorMessage.style.display = 'block';
        }
    } catch (error) {
        console.error('Password verification error:', error);
        errorMessage.textContent = 'Network error. Please check your connection.';
        errorMessage.style.display = 'block';
    }
}

        // Handle download section clicks with API tracking
        async function handleDownloadClick(url, sectionName) {
            const token = localStorage.getItem('auth_token');
            const username = localStorage.getItem('username');

            if (!token) {
                alert('Please log in to access this content.');
                return;
            }

            try {
                // Track user access in backend
                await trackAccess(sectionName, 'CEH v13');
                
                // Navigate to the requested page
                window.location.href = url;

            } catch (error) {
                console.error('Access tracking failed:', error);
                // Still navigate to the page even if tracking fails
                window.location.href = url;
            }
        }

        // Track access function
        async function trackAccess(sectionName, courseName) {
            const token = localStorage.getItem('auth_token');
            const username = localStorage.getItem('username');

            if (!token || !username) return;

            try {
                await fetch(`${API_BASE_URL}/api/track-access`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        username: username,
                        section: sectionName,
                        course: courseName,
                        timestamp: new Date().toISOString()
                    })
                });
            } catch (error) {
                console.error('Access tracking failed:', error);
            }
        }

        // Matrix Digital Rain Animation
        const canvas = document.getElementById('matrix-canvas');
        const ctx = canvas.getContext('2d');

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        resizeCanvas();

        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%^&*()_+-=[]{}|;:,.<>?';
        const charArray = chars.split('');

        const fontSize = 16;
        const columns = canvas.width / fontSize;
        const drops = [];

        for (let i = 0; i < columns; i++) {
            drops[i] = Math.random() * -100;
        }

        function drawMatrix() {
            ctx.fillStyle = 'rgba(2, 4, 10, 0.05)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            ctx.fillStyle = '#00FFB3';
            ctx.font = `${fontSize}px monospace`;

            for (let i = 0; i < drops.length; i++) {
                const char = charArray[Math.floor(Math.random() * charArray.length)];
                const x = i * fontSize;
                const y = drops[i] * fontSize;

                ctx.fillText(char, x, y);

                if (y > canvas.height && Math.random() > 0.975) {
                    drops[i] = 0;
                }
                drops[i]++;
            }
        }

        const matrixInterval = setInterval(drawMatrix, 50);
        window.addEventListener('resize', resizeCanvas);

        // Logout functionality
        document.addEventListener('DOMContentLoaded', function() {
            const logoutBtn = document.getElementById('logout-btn');
            const profileSection = document.getElementById('profile-section');

            // Profile section click handler
            if (profileSection) {
                profileSection.addEventListener('click', function() {
                    window.location.href = 'profile.html';
                });
            }

            // Logout button click handler
            if (logoutBtn) {
                logoutBtn.addEventListener('click', async function(e) {
                    e.preventDefault();
                    if (confirm('Are you sure you want to logout?')) {
                        const token = localStorage.getItem('auth_token');
                        
                        // Call logout API if token exists
                        if (token) {
                            try {
                                await fetch(`${API_BASE_URL}/api/logout`, {
                                    method: 'POST',
                                    headers: {
                                        'Authorization': `Bearer ${token}`,
                                        'Content-Type': 'application/json'
                                    }
                                });
                            } catch (error) {
                                console.error('Logout API call failed:', error);
                            }
                        }
                        
                        // Clear authentication data
                        localStorage.removeItem('auth_token');
                        localStorage.removeItem('token_timestamp');
                        localStorage.removeItem('username');
                        localStorage.removeItem('user_role');
                        localStorage.removeItem('full_name');
                        localStorage.removeItem('profileImage');
                        sessionStorage.clear();
                        
                        // Redirect to login page
                        window.location.href = 'index.html';
                    }
                });
            }
        });

        // Auto-refresh profile data every 5 minutes
        setInterval(loadUserProfileForNavbar, 300000);
    </script>
</body>
</html>


